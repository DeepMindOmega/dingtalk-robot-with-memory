# Clawdbot é…ç½®ç®¡ç†ç»éªŒ

**Type**: long_term
**Source**: opencode_experience
**Created**: 2026-02-14T23:33:37.130521+00:00
**ID**: 94

**Tags**: config

---

## æ¦‚è¿°
æ–‡æ¡£æ—¶é—´èŒƒå›´ï¼š2026-01-30 è‡³ 2026-02-13
ç³»ç»Ÿï¼šClawdbot AIåŠ©æ‰‹

### å¤±è´¥1ï¼šä»¤ç‰Œé…ç½®ä¸ä¸€è‡´å¯¼è‡´è¿æ¥å¤±è´¥
**é—®é¢˜æè¿°**
- æµè§ˆå™¨åŠŸèƒ½æ— æ³•ä½¿ç”¨
- CLIå®¢æˆ·ç«¯è¿æ¥è¢«æ‹’ç»
- é”™è¯¯ä¿¡æ¯ï¼š`gateway closed (1008): unauthorized: gateway token mismatch`

**å¤±è´¥åŸå› **
1. **ä»¤ç‰Œé…ç½®åˆ†æ•£åœ¨å¤šä¸ªä½ç½®**ï¼š
   - é…ç½®æ–‡ä»¶ä¸­ï¼š`gateway.auth.token`
   - é…ç½®æ–‡ä»¶ä¸­ï¼š`gateway.remote.token`
   - ç¯å¢ƒå˜é‡ï¼š`CLAWDBOT_GATEWAY_TOKEN`
   - systemdæœåŠ¡æ–‡ä»¶ï¼š`Environment=CLAWDBOT_GATEWAY_TOKEN`
   - è¿™äº›ä½ç½®çš„ä»¤ç‰Œå€¼ä¸ä¸€è‡´

2. **é…ç½®æ›´æ–°æœªåŒæ­¥**ï¼š
   - ä¿®æ”¹äº†ä¸€ä¸ªä½ç½®çš„ä»¤ç‰Œï¼Œä½†å…¶ä»–ä½ç½®æœªæ›´æ–°
   - æœåŠ¡ä»åœ¨ä½¿ç”¨æ—§çš„ä»¤ç‰Œå€¼

**é”™è¯¯æ—¥å¿—**
```
gateway closed (1008): unauthorized: gateway token mismatch (provide gateway auth token)
Gateway target: ws://127.0.0.1:18789
Source: local loopback
Config: /home/admin/.clawdbot/clawdbot.json
```

**è§£å†³æ–¹æ¡ˆ**
```bash
# 1. ç»Ÿä¸€ä»¤ç‰Œåˆ°æ‰€æœ‰ä½ç½®
export CLAWDBOT_GATEWAY_TOKEN=your_correct_token

# 2. åœ¨é…ç½®æ–‡ä»¶ä¸­ç»Ÿä¸€ä»¤ç‰Œ
cat > ~/.clawdbot/clawdbot.json << 'EOF'
{
  "gateway": {
    "port": 18789,
    "mode": "local",
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "your_correct_token"
    },
    "remote": {
      "token": "your_correct_token"
    },
    "tailscale": {
      "mode": "off",
      "resetOnExit": false
    }
  }
}
EOF

# 3. æ›´æ–°systemdæœåŠ¡æ–‡ä»¶çš„ç¯å¢ƒå˜é‡
cat > ~/.config/systemd/user/clawdbot-gateway.service << 'EOF'
[Unit]
Description=Clawdbot Gateway Service
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/node /home/admin/.npm-global/lib/node_modules/clawdbot/dist/entry.js gateway --port 18789
Environment=CLAWDBOT_GATEWAY_PORT=18789
Environment=CLAWDBOT_GATEWAY_TOKEN=your_correct_token
Restart=on-failure
RestartSec=5

[Install]
WantedBy=default.target
EOF

# 4. é‡æ–°åŠ è½½systemdé…ç½®
systemctl --user daemon-reload

# 5. é‡å¯ç½‘å…³æœåŠ¡
clawdbot gateway stop
clawdbot gateway start

# 6. éªŒè¯æœåŠ¡çŠ¶æ€
clawdbot gateway status
```

**å…³é”®è¦ç‚¹**
- âœ… ç¡®ä¿ä»¤ç‰Œåœ¨æ‰€æœ‰é…ç½®ä½ç½®ä¿æŒä¸€è‡´ï¼ˆé…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€systemdæœåŠ¡æ–‡ä»¶ï¼‰
- âœ… ä¿®æ”¹é…ç½®åå¿…é¡»é‡æ–°åŠ è½½systemdé…ç½®å¹¶é‡å¯æœåŠ¡
- âœ… ä½¿ç”¨systemdå‘½ä»¤ç®¡ç†æœåŠ¡ï¼Œä¸è¦ä½¿ç”¨pkillæ‰‹åŠ¨æ€æ­»è¿›ç¨‹

---

### å¤±è´¥2ï¼šæœåŠ¡ç®¡ç†ä¸å½“å¯¼è‡´é…ç½®æœªç”Ÿæ•ˆ
**é—®é¢˜æè¿°**
- ä¿®æ”¹é…ç½®æ–‡ä»¶åæœåŠ¡ä»åœ¨ä½¿ç”¨æ—§é…ç½®
- ä½¿ç”¨ `pkill -f clawdbot-gateway` æ‰‹åŠ¨æ€æ­»è¿›ç¨‹
- é‡å¯åæœåŠ¡ä»ä½¿ç”¨æ—§çš„ä»¤ç‰Œé…ç½®

**å¤±è´¥åŸå› **
1. **ä½¿ç”¨é”™è¯¯çš„æœåŠ¡ç®¡ç†æ–¹æ³•**ï¼š
   - ä½¿ç”¨ `pkill` æ‰‹åŠ¨æ€æ­»è¿›ç¨‹
   - systemdæœåŠ¡ç®¡ç†å™¨æ— æ³•æ„ŸçŸ¥è¿›ç¨‹å·²è¢«æ€æ­»
   - æ–°å¯åŠ¨çš„è¿›ç¨‹å¯èƒ½ä¸æ˜¯é€šè¿‡systemdç®¡ç†çš„

2. **æœªé‡æ–°åŠ è½½systemdé…ç½®**ï¼š
   - ä¿®æ”¹systemdæœåŠ¡æ–‡ä»¶åæœªè¿è¡Œ `systemctl --user daemon-reload`
   - systemdä»åœ¨ä½¿ç”¨æ—§çš„æœåŠ¡å•å…ƒæ–‡ä»¶

**é”™è¯¯æ—¥å¿—**
```
Port 18789 is already in use.
- pid 1812 admin: clawdbot-gateway (127.0.0.1:18789)
- Gateway already running locally. Stop it (clawdbot gateway stop) or use a different port.
```

**è§£å†³æ–¹æ¡ˆ**
```bash
# é”™è¯¯åšæ³•ï¼ˆä¸è¦è¿™æ ·ï¼‰ï¼š
pkill -f clawdbot-gateway

# æ­£ç¡®åšæ³•ï¼š
# 1. ä½¿ç”¨systemdå‘½ä»¤åœæ­¢æœåŠ¡
systemctl --user stop clawdbot-gateway

# 2. ç¡®è®¤è¿›ç¨‹å·²åœæ­¢
ps aux | grep clawdbot-gateway

# 3. å¦‚æœè¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œä½¿ç”¨systemdå¼ºåˆ¶åœæ­¢
systemctl --user kill -s SIGKILL clawdbot-gateway

# 4. ä¿®æ”¹é…ç½®æ–‡ä»¶
vi ~/.clawdbot/clawdbot.json

# 5. ä¿®æ”¹systemdæœåŠ¡æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰
vi ~/.config/systemd/user/clawdbot-gateway.service

# 6. é‡æ–°åŠ è½½systemdé…ç½®
systemctl --user daemon-reload

# 7. å¯åŠ¨æœåŠ¡
systemctl --user start clawdbot-gateway

# 8. éªŒè¯æœåŠ¡çŠ¶æ€
systemctl --user status clawdbot-gateway
clawdbot gateway status

# 9. æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl --user -u clawdbot-gateway -n 50 -f
```

**å…³é”®è¦ç‚¹**
- âœ… å§‹ç»ˆä½¿ç”¨systemdå‘½ä»¤ç®¡ç†æœåŠ¡ï¼ˆstop/start/restart/statusï¼‰
- âœ… ä¿®æ”¹systemdæœåŠ¡æ–‡ä»¶åå¿…é¡»è¿è¡Œ `systemctl --user daemon-reload`
- âœ… é¿å…ä½¿ç”¨pkillæ‰‹åŠ¨æ€æ­»systemdç®¡ç†çš„è¿›ç¨‹
- âœ… ä½¿ç”¨ `journalctl` æŸ¥çœ‹æœåŠ¡æ—¥å¿—è€Œéæ™®é€šæ—¥å¿—æ–‡ä»¶

---

### å¤±è´¥3ï¼šé…ç½®æ–‡ä»¶ä½ç½®æ··æ·†
**é—®é¢˜æè¿°**
- å¤šä¸ªé…ç½®æ–‡ä»¶åŒæ—¶å­˜åœ¨
- ä¸ç¡®å®šå“ªä¸ªé…ç½®æ–‡ä»¶è¢«å®é™…ä½¿ç”¨
- ä¿®æ”¹é”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´é—®é¢˜æŒç»­å­˜åœ¨

**å¤±è´¥åŸå› **
1. **é…ç½®æ–‡ä»¶ä½ç½®ä¸æ˜ç¡®**ï¼š
   - ä¸»é…ç½®ï¼š`~/.clawdbot/clawdbot.json`
   - å…¶ä»–å¯èƒ½çš„é…ç½®ä½ç½®ï¼š`/etc/clawdbot/config.json`, é¡¹ç›®ç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶
   - ç¯å¢ƒå˜é‡æŒ‡å®šçš„é…ç½®è·¯å¾„

2. **é…ç½®ä¼˜å…ˆçº§ä¸æ¸…æ¥š**ï¼š
   - ä¸æ¸…æ¥šå‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§
   - å¯èƒ½ä½¿ç”¨äº†é”™è¯¯çš„é…ç½®æ–‡ä»¶

**è§£å†³æ–¹æ¡ˆ**
```bash
# 1. æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„é…ç½®æ–‡ä»¶
find ~ -name "clawdbot.json" 2>/dev/null
find /etc -name "clawdbot*" 2>/dev/null

# 2. ç¡®è®¤å®é™…ä½¿ç”¨çš„é…ç½®æ–‡ä»¶è·¯å¾„
clawdbot gateway status
# è¾“å‡ºä¼šæ˜¾ç¤º "Config (cli): ~/.clawdbot/clawdbot.json"

# 3. æŸ¥çœ‹ç¯å¢ƒå˜é‡
echo $CLAWDBOT_CONFIG

# 4. æ£€æŸ¥systemdæœåŠ¡æ–‡ä»¶ä¸­çš„é…ç½®è·¯å¾„
cat ~/.config/systemd/user/clawdbot-gateway.service | grep Config

# 5. ç¡®è®¤å”¯ä¸€çš„é…ç½®æ–‡ä»¶ä½ç½®
# é€šå¸¸ä¸»é…ç½®æ–‡ä»¶ä½äºï¼š~/.clawdbot/clawdbot.json

# 6. å¤‡ä»½å½“å‰é…ç½®
cp ~/.clawdbot/clawdbot.json ~/.clawdbot/clawdbot.json.backup

# 7. ä¿®æ”¹æ­£ç¡®çš„é…ç½®æ–‡ä»¶
vi ~/.clawdbot/clawdbot.json

# 8. éªŒè¯JSONæ ¼å¼
jq '.' ~/.clawdbot/clawdbot.json
```

**å…³é”®è¦ç‚¹**
- âœ… ä¸»é…ç½®æ–‡ä»¶é€šå¸¸ä½äº `~/.clawdbot/clawdbot.json`
- âœ… ä½¿ç”¨ `clawdbot gateway status` ç¡®è®¤å®é™…ä½¿ç”¨çš„é…ç½®è·¯å¾„
- âœ… ä¿®æ”¹é…ç½®å‰å…ˆå¤‡ä»½
- âœ… ä½¿ç”¨jqç­‰å·¥å…·éªŒè¯JSONæ ¼å¼

---

### æˆåŠŸ1ï¼šç»Ÿä¸€é…ç½®ç®¡ç†
**æˆåŠŸæ­¥éª¤**
1. è¯†åˆ«æ‰€æœ‰é…ç½®ä½ç½®ï¼ˆé…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€systemdæœåŠ¡æ–‡ä»¶ï¼‰
2. ç»Ÿä¸€ä»¤ç‰Œé…ç½®åˆ°æ‰€æœ‰ä½ç½®
3. é‡æ–°åŠ è½½systemdé…ç½®
4. ä½¿ç”¨æ­£ç¡®çš„systemdå‘½ä»¤é‡å¯æœåŠ¡
5. éªŒè¯æœåŠ¡çŠ¶æ€å’Œè¿æ¥

**å…³é”®å› ç´ **
- é…ç½®åœ¨æ‰€æœ‰ä½ç½®ä¿æŒä¸€è‡´
- ä½¿ç”¨systemdå‘½ä»¤ç®¡ç†æœåŠ¡
- ä¿®æ”¹åé‡æ–°åŠ è½½é…ç½®
- é‡å¯åéªŒè¯çŠ¶æ€

**é…ç½®ç¤ºä¾‹**
```json
{
  "gateway": {
    "port": 18789,
    "mode": "local",
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "your_correct_token"
    },
    "remote": {
      "token": "your_correct_token"
    }
  }
}
```

---

### æˆåŠŸ2ï¼šsystemdæœåŠ¡æ­£ç¡®ç®¡ç†
**æˆåŠŸæ­¥éª¤**
1. ä½¿ç”¨systemdå‘½ä»¤åœæ­¢æœåŠ¡
2. ä¿®æ”¹é…ç½®æ–‡ä»¶
3. ä¿®æ”¹systemdæœåŠ¡æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰
4. é‡æ–°åŠ è½½systemdé…ç½®
5. å¯åŠ¨æœåŠ¡å¹¶éªŒè¯çŠ¶æ€

**å…³é”®å› ç´ **
- ä½¿ç”¨systemdå‘½ä»¤è€Œépkill
- ä¿®æ”¹æœåŠ¡æ–‡ä»¶åé‡æ–°åŠ è½½é…ç½®
- å¯åŠ¨åéªŒè¯æœåŠ¡çŠ¶æ€
- ä½¿ç”¨journalctlæŸ¥çœ‹æ—¥å¿—

**å‘½ä»¤ç¤ºä¾‹**
```bash
# æ ‡å‡†æœåŠ¡ç®¡ç†æµç¨‹
systemctl --user stop clawdbot-gateway
# ä¿®æ”¹é…ç½®æ–‡ä»¶
systemctl --user daemon-reload
systemctl --user start clawdbot-gateway
systemctl --user status clawdbot-gateway
journalctl --user -u clawdbot-gateway -n 50
```

---

### ğŸ’¡ é‡è¦æŠ€èƒ½å’ŒçŸ¥è¯†


### Clawdboté…ç½®ç®¡ç†
**é…ç½®æ–‡ä»¶ä½ç½®**
- ä¸»é…ç½®ï¼š`~/.clawdbot/clawdbot.json`
- ç¯å¢ƒå˜é‡ï¼š`CLAWDBOT_GATEWAY_TOKEN`, `CLAWDBOT_CONFIG`
- systemdæœåŠ¡ï¼š`~/.config/systemd/user/clawdbot-gateway.service`

**é…ç½®ç»“æ„**
```json
{
  "gateway": {
    "port": 18789,
    "mode": "local",
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "your_auth_token_here"
    },
    "remote": {
      "token": "your_auth_token_here"  // å¿…é¡»ä¸auth.tokenä¸€è‡´
    },
    "tailscale": {
      "mode": "off",
      "resetOnExit": false
    }
  },
  "channels": {
    "dingtalk": {
      "enabled": true,
      "appKey": "your_dingtalk_app_key",
      "appSecret": "your_dingtalk_app_secret"
    }
  }
}
```

### æœåŠ¡ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
clawdbot gateway status
systemctl --user status clawdbot-gateway

# å¯åŠ¨æœåŠ¡
clawdbot gateway start
systemctl --user start clawdbot-gateway

# åœæ­¢æœåŠ¡
clawdbot gateway stop
systemctl --user stop clawdbot-gateway

# é‡å¯æœåŠ¡
clawdbot gateway restart
systemctl --user restart clawdbot-gateway

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl --user -u clawdbot-gateway -n 50
journalctl --user -u clawdbot-gateway -f  # å®æ—¶æŸ¥çœ‹

# é‡æ–°åŠ è½½systemdé…ç½®
systemctl --user daemon-reload

# å¯ç”¨æœåŠ¡å¼€æœºè‡ªå¯åŠ¨
systemctl --user enable clawdbot-gateway

# ç¦ç”¨æœåŠ¡å¼€æœºè‡ªå¯åŠ¨
systemctl --user disable clawdbot-gateway
```

---

### ğŸ“Š å¤±è´¥åŸå› åˆ†æ


### æ ¹æœ¬åŸå› æ€»ç»“
| å¤±è´¥ç±»å‹ | æ ¹æœ¬åŸå›  | é¢‘æ¬¡ |
|---------|---------|------|
| ä»¤ç‰Œé…ç½®ä¸ä¸€è‡´ | é…ç½®åˆ†æ•£åœ¨å¤šä¸ªä½ç½®ä¸”æœªåŒæ­¥æ›´æ–° | 10+æ¬¡ |
| æœåŠ¡ç®¡ç†ä¸å½“ | ä½¿ç”¨pkillè€Œésystemdå‘½ä»¤ | 5æ¬¡ |
| é…ç½®æœªé‡æ–°åŠ è½½ | ä¿®æ”¹systemdæ–‡ä»¶åæœªdaemon-reload | 3æ¬¡ |
| é…ç½®æ–‡ä»¶ä½ç½®æ··æ·† | ä¸æ¸…æ¥šå®é™…ä½¿ç”¨çš„é…ç½®æ–‡ä»¶è·¯å¾„ | 2æ¬¡ |
| JSONæ ¼å¼é”™è¯¯ | é…ç½®æ–‡ä»¶è¯­æ³•é”™è¯¯ | 1æ¬¡ |

---

### ğŸ¯ æœ€ä½³å®è·µ


### 1. é…ç½®ä¸€è‡´æ€§
1. **ç»Ÿä¸€é…ç½®æº**
   - å°†ä¸»é…ç½®ä½œä¸ºå•ä¸€äº‹å®æ¥æº
   - ç¡®ä¿æ‰€æœ‰é…ç½®ä½ç½®ä¸ä¸»é…ç½®ä¸€è‡´
   - ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é…ç½®å˜æ›´

2. **é…ç½®éªŒè¯**
   - ä¿®æ”¹å‰å¤‡ä»½åŸé…ç½®
   - ä¿®æ”¹åéªŒè¯JSONæ ¼å¼
   - é‡å¯å‰ç¡®è®¤é…ç½®æ­£ç¡®

### 2. æœåŠ¡ç®¡ç†
1. **ä½¿ç”¨systemdå‘½ä»¤**
   - å§‹ç»ˆä½¿ç”¨systemctlå‘½ä»¤ç®¡ç†æœåŠ¡
   - é¿å…ä½¿ç”¨pkillæ‰‹åŠ¨æ€æ­»è¿›ç¨‹
   - ä¿®æ”¹æœåŠ¡æ–‡ä»¶åå¿…é¡»daemon-reload

2. **æ—¥å¿—ç›‘æ§**
   - ä½¿ç”¨journalctlæŸ¥çœ‹æœåŠ¡æ—¥å¿—
   - å®æ—¶ç›‘æ§æœåŠ¡çŠ¶æ€
   - å®šæœŸæ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€

### 3. é—®é¢˜æ’æŸ¥
1. **é…ç½®é—®é¢˜æ’æŸ¥**
   ```bash
   # ç¡®è®¤é…ç½®æ–‡ä»¶è·¯å¾„
   clawdbot gateway status

   # éªŒè¯JSONæ ¼å¼
   jq '.' ~/.clawdbot/clawdbot.json

   # æŸ¥çœ‹ç¯å¢ƒå˜é‡
   echo $CLAWDBOT_GATEWAY_TOKEN

   # æŸ¥æ‰¾æ‰€æœ‰é…ç½®æ–‡ä»¶
   find ~ -name "clawdbot.json"
   ```

2. **æœåŠ¡é—®é¢˜æ’æŸ¥**
   ```bash
   # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
   systemctl --user status clawdbot-gateway

   # æŸ¥çœ‹æœåŠ¡æ—¥å¿—
   journalctl --user -u clawdbot-gateway -n 100

   # æ£€æŸ¥è¿›ç¨‹
   ps aux | grep clawdbot

   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -tuln | grep 18789
   ```

---

### ğŸ”§ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥


### é…ç½®ç®¡ç†
```bash
# å¤‡ä»½é…ç½®
cp ~/.clawdbot/clawdbot.json ~/.clawdbot/clawdbot.json.backup

# ç¼–è¾‘é…ç½®
vi ~/.clawdbot/clawdbot.json

# éªŒè¯JSONæ ¼å¼
jq '.' ~/.clawdbot/clawdbot.json

# æŸ¥çœ‹å½“å‰é…ç½®
cat ~/.clawdbot/clawdbot.json | jq

# ä¿®æ”¹ä»¤ç‰Œï¼ˆç¤ºä¾‹ï¼‰
jq '.gateway.auth.token = "new_token"' ~/.clawdbot/clawdbot.json > /tmp/config.json
mv /tmp/config.json ~/.clawdbot/clawdbot.json
```

### æœåŠ¡ç®¡ç†
```bash
# é‡å¯æœåŠ¡ï¼ˆæ ‡å‡†æµç¨‹ï¼‰
clawdbot gateway restart
# ç­‰ä»·äºï¼š
systemctl --user restart clawdbot-gateway

# æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
clawdbot gateway status
systemctl --user status clawdbot-gateway -l

# æŸ¥çœ‹æ—¥å¿—
journalctl --user -u clawdbot-gateway -n 50
journalctl --user -u clawdbot-gateway --since "5 minutes ago"
journalctl --user -u clawdbot-gateway -f  # å®æ—¶è·Ÿè¸ª
```

---

*æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š2026-02-15*
*åŸºäºClawdbotå¯¹è¯è®°å½•æ•´ç†å®Œæˆ*